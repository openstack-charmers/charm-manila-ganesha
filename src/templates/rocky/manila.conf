# Note that the original manila.conf file is extensive and has many options
# that the charm does not set.  Please refer to that file if there are options
# that you think the charm should set, but doesn't, or provide options for.
# Please file a bug at: https://bugs.launchpad.net/charm-barbican/+filebug for
# any changes you need made or intend to modify in the charm.

[DEFAULT]

osapi_share_extension = manila.api.contrib.standard_extenstions
rootwrap_config = /etc/manila/rootwrap.conf
api_paste_config = /etc/manila/api-paste.ini
share_name_template = share-%s

my_ip = {{ options.access_ip }}

scheduler_driver = manila.scheduler.drivers.filter.FilterScheduler

debug = {{ options.debug }}

# Number of workers for OpenStack Share API service. (integer value)
osapi_share_workers = {{ options.workers }}

{% include "parts/section-transport-url" %}

# parts/section-database includes the [database] section identifier
{% include "parts/section-database" %}


# parts/section-keystone-authtoken includes the [keystone_authtoken] section
# identifier
{% include "parts/section-keystone-authtoken" %}

[oslo_messaging_amqp]

#
# From oslo.messaging
#

[oslo_messaging_notifications]

#
# From oslo.messaging
#

{% include "parts/section-oslo-messaging-rabbit" %}

[ganesha]
driver_handles_share_servers = False
share_backend_name = GANESHA
share_driver = manila.share.drivers.cephfs.driver.CephFSDriver
cephfs_protocol_helper_type = NFS
cephfs_conf_path = /etc/ceph/ceph.conf
cephfs_auth_id = manila
cephfs_cluster_name = ceph
cephfs_enable_snapshots = False
cephfs_ganesha_server_is_remote = False
cephfs_ganesha_server_ip = {{ options.access_ip }}
